<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Flttx&#39;s Blog â€¢ Posts by &#34;h5 app&#34; tag</title>
        <link>https://flttx.github.io
        <description></description>
        <language></language>
        <pubdate>Thu, 15 Aug 2019 10:09:02 +0800</pubdate>
        <lastbuilddate>Thu, 15 Aug 2019 10:09:02 +0800</lastbuilddate>
        <category>react</category>
        <category>å¾®ä¿¡å°ç¨‹åº</category>
        <category>H5 APP</category>
        <item>
            <guid ispermalink="true">https://flttx.github.io/2019/08/15/æ‰‹æœºç«¯è°ƒç”¨ç™¾åº¦å›¾ç‰‡è¯†åˆ«API/</guid>
            <title>æ‰‹æœºç«¯è°ƒç”¨ç™¾åº¦å›¾ç‰‡è¯†åˆ«API</title>
            <link>https://flttx.github.io/2019/08/15/æ‰‹æœºç«¯è°ƒç”¨ç™¾åº¦å›¾ç‰‡è¯†åˆ«API/
            <category>H5 APP</category>
            <pubdate>Thu, 15 Aug 2019 10:09:02 +0800</pubdate>
            <description><!--[CDATA[ &lt;p&gt;å› ä¸ºä¸šåŠ¡éœ€æ±‚ï¼Œæœ‰è½¦ç‰Œè¯†åˆ«çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä¸Šç½‘æ‰¾äº†å›¾ç‰‡è¯†åˆ«çš„è§£å†³æ–¹æ¡ˆï¼Œå‘ç° BAT éƒ½æœ‰ï¼Œä½†æ˜¯ç™¾åº¦çš„å…è´¹æ¬¡æ•°æœ€å¤šï¼Œå¯¹ä¸šåŠ¡æ¥è¯´å°±ç›¸å½“äºå…¨å…è´¹äº†ï¼Œæ‰€ä»¥å°±é€‰æ‹©äº†ç™¾åº¦çš„ APIï¼ŒğŸ˜„ã€‚å®˜æ–¹æ–‡æ¡£åœ°å€ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9haS5iYWlkdS5jb20vZG9jcyMvT0NSLUFQSS90b3AlRTMlODAlODI=&#34;&gt;https://ai.baidu.com/docs#/OCR-API/topã€‚&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;1æ‹ç…§è·å–å›¾ç‰‡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1æ‹ç…§è·å–å›¾ç‰‡&#34;&gt;#&lt;/a&gt; 1. æ‹ç…§è·å–å›¾ç‰‡&lt;/h1&gt;
&lt;p&gt;é¡¹ç›®æ˜¯ H5 APPï¼Œæ‹ç…§ç”¨äº† H5 + çš„ apiã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;//æ‹ç…§&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;captureImage() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    let _this = this;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    var cmr = plus.camera.getCamera();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    var res = cmr.supportedImageResolutions[0];  //æ‘„åƒå¤´æ”¯æŒçš„æ‹ç…§åˆ†è¾¨ç‡&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    var fmt = cmr.supportedImageFormats[0]; //æ‘„åƒå¤´æ”¯æŒçš„æ‹ç…§æ–‡ä»¶æ ¼å¼&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cmr.captureImage((path)=&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            _this.convertUrl(path);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        function(error) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            console.log(&amp;quot;Capture image failed: &amp;quot; + error.message);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            resolution: res,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            format: fmt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;2å›¾ç‰‡è½¬base64&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2å›¾ç‰‡è½¬base64&#34;&gt;#&lt;/a&gt; 2. å›¾ç‰‡è½¬ base64&lt;/h1&gt;
&lt;p&gt;æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œå›¾ç‰‡è¦è½¬æˆ base64 æ•°æ®ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;//è½¬æ¢å›¾ç‰‡è·¯å¾„å¹¶è°ƒç”¨æ–¹æ³•è¯†åˆ«&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;convertUrl(path)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    let _this = this;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    //è½¬æ¢ä¸ºæœ¬åœ°æ–‡ä»¶è·¯å¾„&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plus.io.resolveLocalFileSystemURL(path, function(entry) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        var localurl = entry.toLocalURL(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        var reader = new plus.io.FileReader();  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        reader.onloadend = function (e) &amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                var imgData = e.target.result.replace(&amp;quot;data:image/jpeg;base64,&amp;quot;, &amp;quot;&amp;quot;).replace(&amp;quot;data:image/png;base64,&amp;quot;, &amp;quot;&amp;quot;);//base64å›¾ç‰‡  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                ocr.startOCR(imgData, res=&amp;gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                var number = res.words_result.number;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                if(number.length == 7)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    uni.showToast(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        title: &amp;quot;è¯†åˆ«æˆåŠŸ&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        icon: &amp;quot;none&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    var values = number.split(&amp;quot;&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    _this.result = values;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        reader.readAsDataURL(localurl);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;3è·å–access-token&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3è·å–access-token&#34;&gt;#&lt;/a&gt; 3. è·å– Access Token&lt;/h1&gt;
&lt;p&gt;å¥½äº†ï¼Œç°åœ¨å›¾ç‰‡æ•°æ®æœ‰äº†ï¼Œåœ¨è°ƒç™¾åº¦è½¦ç‰Œè¯†åˆ« API ä¹‹å‰è¿˜è¦å…ˆè·å– Access Token, è€Œè¦è·å– Access Tokenï¼Œåˆå¾—å…ˆç™»è®°ä¸€ä¸ªåº”ç”¨ï¼Œå–åˆ°åº”ç”¨çš„ API KEY å’Œ SECRET KEYã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;//è·å–access_token&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;function requestAccessToken(callback) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	let params = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		grant_type: &amp;apos;client_credentials&amp;apos;,  //å›ºå®šå€¼&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		client_id: api_key,  //ç™»è®°åº”ç”¨çš„API KEY&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		client_secret: secret_key //ç™»è®°åº”ç”¨çš„SECRET KEY&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    //networkæ˜¯å°è£…çš„ajaxè¯·æ±‚å‡½æ•°&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	network.request(&amp;apos;https://aip.baidubce.com/oauth/2.0/token&amp;apos;, params, null, &amp;quot;GET&amp;quot;, res =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		if (res.hasOwnProperty(&amp;apos;access_token&amp;apos;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			let nowTime = new Date().getTime();  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            //è®°å½•å½“å‰è¯·æ±‚æ—¶é—´æ˜¯ä¸ºäº†åˆ¤æ–­access_tokenæ˜¯å¦è¿‡æœŸ&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			let access_token_obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;				access_token: res.access_token,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;				requestTime: nowTime  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			uni.setStorageSync(&amp;quot;access_token_obj&amp;quot;, access_token_obj)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			callback(res.access_token);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&amp;#125; else &amp;#123; //è·å–access_tokenå¤±è´¥&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			console.log(JSON.stringify(res));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;4è°ƒç”¨è½¦ç‰Œè¯†åˆ«api&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4è°ƒç”¨è½¦ç‰Œè¯†åˆ«api&#34;&gt;#&lt;/a&gt; 4. è°ƒç”¨è½¦ç‰Œè¯†åˆ« API&lt;/h1&gt;
&lt;p&gt;å…ˆåˆ¤æ–­ä¹‹å‰æ˜¯å¦è¯·æ±‚è¿‡ access_tokenï¼Œå¦‚æœè¯·æ±‚è¿‡å†åˆ¤æ–­ access_token æ˜¯å¦è¿‡æœŸã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; * å¼€å§‹è¿›è¡Œæ–‡å­—è¯†åˆ«ï¼Œä¼ å…¥base64å›¾ç‰‡æ•°æ®å’Œå›è°ƒå‡½æ•°&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; */&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;function startOCR(imgData, callback) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	console.log(&amp;quot;å¼€å§‹è¯†åˆ«...&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	console.log(&amp;quot;access_tokenç¼“å­˜ï¼Ÿ&amp;quot; + uni.getStorageSync(&amp;quot;access_token_obj&amp;quot;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	if (uni.getStorageSync(&amp;quot;access_token_obj&amp;quot;)) &amp;#123; //å¦‚æœaccess_tokenå·²å­˜å…¥ç¼“å­˜ï¼Œè¡¨ç¤ºè¯·æ±‚è¿‡&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		let obj = uni.getStorageSync(&amp;quot;access_token_obj&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		let nowTime = new Date().getTime();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		if ((nowTime - obj.requestTime) &amp;gt;= 1000 * 3600 * 24 * 30) &amp;#123; //å¦‚æœä¸Šæ¬¡è¯·æ±‚æ—¶é—´åœ¨30å¤©ä¹‹å‰ï¼Œåˆ™éœ€è¦é‡æ–°è·å–access_token&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			requestAccessToken(res =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;				recognition(res, imgData, callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			recognition(obj.access_token, imgData, callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125; else &amp;#123; //ç¼“å­˜ä¸­æ²¡æœ‰access_token&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		requestAccessToken(res =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			recognition(res, imgData, callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;//è¯†åˆ«ä¸­...è°ƒç”¨æ–‡å­—è¯†åˆ«API,ä¼ å…¥å›¾ç‰‡æ•°æ®å‚æ•°&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;function recognition(access_token, imgData, callback) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	let params = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		access_token: access_token,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		image: imgData&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	let header = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&amp;apos;Content-Type&amp;apos;: &amp;apos;application/x-www-form-urlencoded&amp;apos;  //è¯·æ±‚å¤´è®¾ç½®æˆå›ºå®šå€¼&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	network.request(&amp;apos;https://aip.baidubce.com/rest/2.0/ocr/v1/license_plate&amp;apos;, params, header, &amp;quot;POST&amp;quot;, res =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		callback(res);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;, err =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		uni.showToast(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			title: &amp;quot;è¯·å¯¹å‡†è½¦ç‰Œé‡æ–°æ‹ç…§&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			icon: &amp;quot;none&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;, &amp;quot;è¯†åˆ«ä¸­...&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åªè¦å‚æ•°éƒ½æ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±èƒ½å¾—åˆ°è¿”å›ç»“æœï¼Œè¿”å›è½¦ç‰Œä¿¡æ¯ï¼ˆè½¦ç‰Œå·ã€è½¦ç‰Œé¢œè‰²ç­‰ç­‰ï¼‰ã€‚&lt;br&gt;
è°ƒç”¨å…¶ä»–åœºæ™¯çš„å›¾ç‰‡è¯†åˆ« API åŒç†ã€‚&lt;/p&gt;
 ]]--></description>
        </item>
    </channel>
</rss>
